{% extends 'dashboard.html' %}
{% load static %}
{% block title %}brand | Add-brand{% endblock %}
{% block content %}

<div class="main-content-inner">
    <!-- main-content-wrap -->
    <div class="main-content-wrap">
        <div class="flex items-center flex-wrap justify-between gap20 mb-27">
            <h3>Add Brands</h3>
            <ul class="breadcrumbs flex items-center flex-wrap justify-start gap10">
                <li>
                    <a href="#">
                        <div class="text-tiny">Dashboard</div>
                    </a>
                </li>
                <li>
                    <i class="icon-chevron-right"></i>
                </li>
                <li>
                    <a href="#">
                        <div class="text-tiny">Brands</div>
                    </a>
                </li>
                <li>
                    <i class="icon-chevron-right"></i>
                </li>
                <li>
                    <div class="text-tiny">New brand</div>
                </li>
            </ul>
        </div>
        <!-- new-category -->
        <div class="wg-box">
           <form class="form-new-product form-style-1" action="" method="POST" enctype="multipart/form-data">
    {% csrf_token %}
    <fieldset class="name">
        <div class="body-title">brand Name <span class="tf-color-1">*</span></div>
        <input class="flex-grow" type="text" id="productName" placeholder="brand name" name="name"
               tabindex="0" value="{{ form.name.value|default_if_none:'' }}" aria-required="true" required="">
    </fieldset>

    <fieldset class="name">
        <div class="body-title">brand Slug <span class="tf-color-1">*</span></div>
        <input class="flex-grow" type="text" id="productSlug" placeholder="brand Slug" name="slug"
               tabindex="0" value="{{ form.slug.value|default_if_none:'' }}" aria-required="true" required="">
    </fieldset>

    <fieldset>
        <div class="body-title">Upload images <span class="tf-color-1">*</span></div>
        <div class="upload-image flex-grow d-flex flex-wrap gap-2" id="singleImagePreview">
            {% if brand and brand.image %}
            <div class="item" id="imgpreview" style="position: relative;">
                <img id="previewImg" src="{{ brand.image.url }}" class="effect8" alt="{{ brand.name }}" style="max-height: 120px; border-radius: 8px;">
                <button type="button" class="remove-btn" onclick="removeSingleImage()">×</button>
            </div>
            {% else %}
            <div id="imgpreview" class="item" style="display:none; position: relative;">
                <img id="previewImg" src="" class="effect8" alt="" style="max-height: 120px; border-radius: 8px;">
                <button type="button" class="remove-btn" onclick="removeSingleImage()">×</button>
            </div>
            {% endif %}
            <div id="upload-file" class="item up-load">
                <label class="uploadfile" for="myFile">
                    <span class="icon"><i class="icon-upload-cloud"></i></span>
                    <span class="body-text">Drop your images here or select <span class="tf-color">click to browse</span></span>
                    <input type="file" id="myFile" name="image" accept="image/*">
                </label>
            </div>
        </div>
    </fieldset>

    <div class="bot">
        <div></div>
        <button class="tf-button w208" type="submit">{% if category %}Update{% else %}Save{% endif %}</button>
    </div>
</form>

        </div>
    </div>
</div>
<script>
// function to slugify text
function slugify(text) {
    return text
        .toString()
        .toLowerCase()
        .trim()
        .replace(/&/g, '-and-')         
        .replace(/[\s\W-]+/g, '-')      
        .replace(/^-+|-+$/g, '');     
}

// auto update slug when typing in product name
document.getElementById("productName").addEventListener("input", function() {
    let name = this.value;
    let slug = slugify(name);
    document.getElementById("productSlug").value = slug;
});
</script>
{% endblock %}